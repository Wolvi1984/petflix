<table class="table table-striped">
  <tr>
    <td th:fragment="pets"><span ng-if="pet.video"><a href="#"
        title="Watch Video" data-toggle="modal"
        data-target="#pet-{{pet.id}}"><i
          class="glyphicon glyphicon-facetime-video"></i></a></span> <span><span
        ng-repeat="star in pet.stars"
        class="glyphicon glyphicon-{{star}}"></span></span> <!-- Modal -->
      <div class="modal fade" id="pet-{{pet.id}}" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">
                Video of {{pet.name}} <span><a href="#"
                  title="Rate this Video" ng-repeat="star in pet.stars"
                  class="glyphicon
                    glyphicon-{{star}}"></a></span>
              </h4>
            </div>
            <div class="modal-body" ng-bind-html="pet.video"></div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default"
                data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div></td>
  </tr>
</table>
<script type="text/javascript">
    angular
            .module("app", [])
            .controller(
                    "owner",
                    function($http, $sce) {
                        var self = this;
                        self.pets = [];
                        fetch = function(pet) {
                            $http
                                    .get("videos/" + pet.id)
                                    .then(
                                            function(response) {
                                                var stars = response.data.stars;
                                                pet.stars = {};
                                                for (var i = 0; i < stars; i++) {
                                                    pet.stars[i] = "star";
                                                }
                                                for (var i = stars; i < 5; i++) {
                                                    pet.stars[i] = "star-empty";
                                                }
                                                pet.video = $sce
                                                        .trustAsHtml('<iframe width="500" height="300" src="' + response.data.url + '" frameborder="0" allowfullscreen></iframe>');
                                            });
                        };
                        $http.get("#").then(function(response) {
                            self.pets = response.data.pets;
                            for (var i = 0; i < self.pets.length; i++) {
                                var pet = self.pets[i]
                                fetch(pet);
                            }
                        });
                    });
</script>